<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlantDoc AI</title>
    <style>
        body { font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; flex-direction: column; min-height: 100vh; background-color: #f4f7f6; }
        #container { background: #fff; padding: 2rem; border-radius: 12px; box-shadow: 0 8px 30px rgba(0,0,0,0.05); text-align: center; }
        h1 { color: #2c5f2d; }
        #file-input { display: none; }
        #upload-label { display: inline-block; padding: 12px 25px; background-color: #2c5f2d; color: white; font-weight: bold; border-radius: 8px; cursor: pointer; transition: background-color 0.3s ease; }
        #upload-label:hover { background-color: #1e421f; }
        #image-preview { max-width: 100%; max-height: 300px; margin-top: 20px; border-radius: 8px; border: 1px solid #ddd; display: none; }
        #result-box { margin-top: 20px; padding: 15px; border-radius: 8px; background-color: #f9f9f9; border: 1px solid #eee; display: none; }
        #result-disease { font-size: 1.3rem; font-weight: bold; color: #d9534f; }
        #result-confidence { font-size: 1rem; color: #777; }
    </style>
</head>
<body>
    <div id="container">
        <h1>ðŸŒ¿ Plant Disease Detector</h1>
        <p>Upload a leaf image for AI diagnosis.</p>
        <input type="file" id="file-input" accept="image/*">
        <label for="file-input" id="upload-label">Upload Image</label>
        <img id="image-preview" src="" alt="Image Preview">
        <div id="result-box">
            <div id="result-disease">Processing...</div>
            <div id="result-confidence"></div>
        </div>
    </div>
    <script>
        const fileInput = document.getElementById('file-input');
        const imagePreview = document.getElementById('image-preview');
        const resultBox = document.getElementById('result-box');
        const resultDisease = document.getElementById('result-disease');
        const resultConfidence = document.getElementById('result-confidence');
        const API_ENDPOINT = 'http://127.0.0.1:5000/predict';

        fileInput.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => { imagePreview.src = e.target.result; imagePreview.style.display = 'block'; };
                reader.readAsDataURL(file);
                resultBox.style.display = 'block';
                resultDisease.innerText = 'Analyzing leaf...';
                resultConfidence.innerText = 'Please wait.';
                sendImageToAPI(file);
            }
        });

        async function sendImageToAPI(file) {
            const formData = new FormData();
            formData.append('file', file);
            try {
                const response = await fetch(API_ENDPOINT, { method: 'POST', body: formData });
                const data = await response.json();
                if (data.error) { throw new Error(data.error); }
                const disease = data.disease;
                const confidence = (data.confidence * 100).toFixed(2);
                resultDisease.innerText = disease;
                resultConfidence.innerText = `Confidence: ${confidence}%`;
                resultDisease.style.color = disease.toLowerCase().includes('healthy') ? '#2c5f2d' : '#d9534f';
            } catch (error) {
                console.error('Error:', error);
                resultDisease.innerText = 'Prediction Failed';
                resultConfidence.innerText = error.message;
            }
        }
    </script>
</body>
</html>